#!/usr/bin/env bash

cd "$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )/.." || exit 1

if [ -z ${CI+x} ]; then
    echo "Not a CI environment"
    exit 1
fi

# CIRCLECI
# GITHUB_WORKFLOW

case "$(uname)" in
    Linux*) export PLATFORM="linux";
        pip install -r requirements.txt || exit 1
        pip install -e . || exit 1
        ;;
    Darwin*) export PLATFORM="darwin";
        sudo -H pip install -r requirements.txt || exit 1
        sudo -H pip install -e . || exit 1
        ;;
    CYGWIN*) export PLATFORM="windows";
        pip install -r requirements.txt || exit 1
        pip install -e . || exit 1
        ;;
esac

echo "Installed clowder for $PLATFORM"
